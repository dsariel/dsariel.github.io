<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <h1 id="general">General</h1> <p>OpenShift login tokens expire because they are, by default, valid for a limited time (e.g., 24 hours). There are several ways to re-login.</p> <h2 id="obtain-a-token-from-a-web-console">Obtain a token from a web console</h2> <p>If you have access to the web console and re-login from there:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oc <span class="nb">whoami</span> <span class="nt">--show-console</span>
</code></pre></div></div> <h2 id="run-a-re-login-script">Run a re-login script</h2> <p>If connecting via the web console is not an option, ssh into the controller machine and run the <a href="https://github.com/dsariel/scripts/blob/master/OpenShift/relogin.sh" rel="external nofollow noopener" target="_blank">relogin.sh script</a>:</p> <script>fetch("https://raw.githubusercontent.com/dsariel/scripts/master/OpenShift/relogin.sh").then(t=>t.text()).then(t=>{document.getElementById("script-content").textContent=t});</script> <pre id="script-content">Loading...</pre> <h2 id="steps-to-obtain-a-new-token-using-command-line-browser">Steps to Obtain a New Token using command line browser</h2> <p>Another (more laborious) way is using a text-based web browser on the remote server (again, if the web console is not an option). Follow these steps to obtain a new token and continue working with the cluster:</p> <ol> <li> <p><strong>Install a Text-Based Browser</strong><br> Install <code class="language-plaintext highlighter-rouge">lynx</code>, a command-line browser, to access the token request page:</p> <div class="language-bash highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>yum <span class="nb">install </span>lynx <span class="nt">-y</span>
</code></pre></div> </div> </li> <li> <p><strong>Retrieve a password for the <code class="language-plaintext highlighter-rouge">kubeadmin</code> user</strong><br> If you are using the default <code class="language-plaintext highlighter-rouge">kubeadmin</code> user, retrieve the password from the installation directory:</p> <div class="language-bash highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> ~/.kube/kubeadmin-password
</code></pre></div> </div> <p>Use this password to log in as <code class="language-plaintext highlighter-rouge">kubeadmin</code> in the browser interface during the next stage.</p> </li> <li> <p><strong>Access the Token Request Page</strong><br> Use <code class="language-plaintext highlighter-rouge">lynx</code> to navigate to the token request page:</p> <div class="language-bash highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>lynx https://oauth-openshift.apps.ocp.openstack.lab/oauth/token/request
</code></pre></div> </div> </li> <li> <p><strong>Obtain a New Token</strong><br> Once logged in, obtain a new token. The login command will look like this:</p> <div class="language-bash highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>oc login <span class="nt">--token</span><span class="o">=</span>sha256~&lt;...&gt; <span class="nt">--server</span><span class="o">=</span>https://api.ocp.openstack.lab:6443
</code></pre></div> </div> </li> </ol> </body></html>